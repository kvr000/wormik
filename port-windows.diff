diff -urN wormik/archs.h wormik-windos/archs.h
--- wormik/archs.h	1970-01-01 01:00:00.000000000 +0100
+++ wormik-windos/archs.h	2003-11-28 15:17:08.000000000 +0100
@@ -0,0 +1,29 @@
+#ifdef _WIN32
+
+#include <windows.h>
+#include <excpt.h>
+#include <windef.h>
+#include <winbase.h>
+#include <malloc.h>
+
+#define s64 __int64
+#define snprintf _snprintf
+#define vsnprintf _vsnprintf
+#define open _open
+#define popen _popen
+#define pclose _pclose
+#define alloca _alloca
+
+inline int ftruncate(int fd, size_t size)
+{
+	return _chsize(fd, size);
+}
+
+#else
+
+#ifndef s64
+typedef long long s64;
+#define s64 s64
+#endif
+
+#endif
diff -urN wormik/bconfig.h wormik-windos/bconfig.h
--- wormik/bconfig.h	1970-01-01 01:00:00.000000000 +0100
+++ wormik-windos/bconfig.h	2003-11-28 15:17:08.000000000 +0100
@@ -0,0 +1,14 @@
+#ifdef _WIN32
+
+#undef _POSIX_
+#include <io.h>
+#include <malloc.h>
+#ifndef _POSIX_
+#define _POSIX_
+#endif
+
+#else
+
+#define HAVE_UNISTD_H
+
+#endif
diff -urN wormik/WormikGame.cxx wormik-windos/WormikGame.cxx
--- wormik/WormikGame.cxx	2003-11-28 14:58:08.000000000 +0100
+++ wormik-windos/WormikGame.cxx	2003-11-28 15:17:56.000000000 +0100
@@ -4,6 +4,8 @@
  *
  * Game class
  */
+#include "bconfig.h"
+
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
@@ -13,9 +15,13 @@
 
 #include <limits.h>
 #include <fcntl.h>
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
+#endif
 #include <time.h>
 
+#include "archs.h"
+
 #include "WormikGame_If.hxx"
 #include "WormikGui_If.hxx"
 
@@ -130,7 +136,7 @@
 		break;
 	}
 #endif
-	return min+(long long)rand()*(max-min+1)/((unsigned)RAND_MAX+1);
+	return min+(s64)rand()*(max-min+1)/((unsigned)RAND_MAX+1);
 }
 
 WormikGame::WormikGame():
@@ -155,8 +161,13 @@
 	if (snprintf(buf, sizeof(buf), "%s/.wormikrc", home?home:".") >= (int)sizeof(buf))
 		return NULL;
-	if ((fd = open(buf, mode|O_CREAT, 0666)) < 0)
+#if (defined _WIN32)
+	if ((fd = open(buf, mode|O_CREAT|O_BINARY, 0666)) < 0)
 		return NULL;
-	return fdopen(fd, (mode == O_RDONLY)?"r":"r+");
+#else
+	if ((fd = open(buf, mode|O_CREAT, 0666)) < 0)
+		return NULL;
+#endif
+	return fdopen(fd, (mode == O_RDONLY)?"rb":"r+b");
 }
 
 void WormikGame::setConfig(const char *name, int value)
diff -urN wormik/gui_common.cxx wormik-windos/gui_common.cxx
--- wormik/gui_common.cxx	2003-11-28 11:24:43.000000000 +0100
+++ wormik-windos/gui_common.cxx	2003-11-28 15:17:08.000000000 +0100
@@ -39,28 +39,28 @@
 const int body_image_pos[4][4][2] =
 {
 	{
-		{ },
+		{ 9, 9 },
 		{ 0, 3 },
 		{ 0, 4 },
 		{ 2, 2 },
 	},
 	{
 		{ 2, 3 },
-		{ },
+		{ 9, 9 },
 		{ 1, 3 },
 		{ 1, 4 },
 	},
 	{
 		{ 2, 4 },
 		{ 3, 3 },
-		{ },
+		{ 9, 9 },
 		{ 1, 2 },
 	},
 	{
 		{ 0, 2 },
 		{ 3, 4 },
 		{ 3, 2 },
-		{ },
+		{ 9, 9 },
 	},
 };
 
diff -urN wormik/Wormik_SDL.cxx wormik-windos/Wormik_SDL.cxx
--- wormik/Wormik_SDL.cxx	2003-11-28 14:58:24.000000000 +0100
+++ wormik-windos/Wormik_SDL.cxx	2003-11-28 15:18:58.000000000 +0100
@@ -5,6 +5,8 @@
  * SDL GUI class
  */
 
+#include "bconfig.h"
+
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
@@ -12,10 +14,16 @@
 #include <assert.h>
 #include <stdarg.h>
 
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
+#endif
 #include <limits.h>
 #include <time.h>
+#ifdef HAVE_UNISTD_H
 #include <sys/time.h>
+#endif
+
+#include "archs.h"
 
 #include <SDL/SDL.h>
 #include <SDL/SDL_image.h>
@@ -105,9 +113,13 @@
 
 static double getdtime(void)
 {
+#ifdef _WIN32
+	return GetTickCount()/1000.0;
+#else
 	struct timeval t;
 	gettimeofday(&t, NULL);
 	return t.tv_sec+t.tv_usec/1000000.0;
+#endif
 }
 
 Wormik_SDL::Wormik_SDL()
@@ -232,11 +244,22 @@
 		if (!(ffo = SDL_RWFromFile(buf, "r")))
 			game->error("Couldn't open font file specified in config (trying default): %s\n", strerror(errno));
 	}
-	if (!ffo && !(ffo = findopenfile("courbd.ttf", "d/usr/lib/X11/fonts/TrueType", "l", "s/usr/lib/X11/fonts", "s/usr/share/fonts", NULL))) {
+	if (!ffo && 
+#ifdef _WIN32
+		(strcpy(buf, "d"), GetSystemDirectory(buf+1, sizeof(buf)), strcat(buf, "/../fonts"), !(ffo = findopenfile("courbd.ttf", buf, NULL)))
+#else
+		!(ffo = findopenfile("courbd.ttf", "d/usr/lib/X11/fonts/TrueType", "l", "s/usr/lib/X11/fonts", "s/usr/share/fonts", NULL))
+#endif
+		) {
 		game->fatal("Couldn't find/open output font\n");
 		goto err;
 	}
-	if (!(font = TTF_OpenFontRW(ffo, 1, game->getConfigInt("fontsize", 15)))) {
+	if (
+		!(font = TTF_OpenFontRW(ffo, 1, game->getConfigInt("fontsize", 15)))
+#ifdef _WIN32
+		&& (strcat(buf, "/courbd.ttf"), !(font = TTF_OpenFont(buf+1, 15)))
+#endif
+		) {
 		game->error("Couldn't open output font: %s\n", TTF_GetError());
 		goto err;
 	}
@@ -322,7 +345,11 @@
 		else
 			break;
 	}
-	if (!(img = IMG_Load_RW(sf, 1))) {
+	if (!(img = IMG_Load_RW(sf, 1))
+#ifdef _WIN32
+		&& (sprintf(fname, "wormik_%d.png", season), !(img = IMG_Load(fname)))
+#endif
+		) {
 		game->fatal("failed to process image %s: %s\n", fname, SDL_GetError());
 	}
 	if (img->w != SIMG_WIDTH || img->h != SIMG_HEIGTH || img->format->BytesPerPixel != 4) {
diff -urN wormik/main.cxx wormik-windos/main.cxx
--- wormik/main.cxx	2003-11-28 11:25:35.000000000 +0100
+++ wormik-windos/main.cxx	2003-11-28 15:28:40.000000000 +0100
@@ -5,13 +5,19 @@
  * main function
  */
 
+#include "bconfig.h"
+
 #include <stdio.h>
 #include <stdlib.h>
 #include <string.h>
 #include <math.h>
+#ifdef HAVE_UNISTD_H
 #include <sys/time.h>
+#endif
 #include <sys/types.h>
+#ifdef HAVE_UNISTD_H
 #include <unistd.h>
+#endif
 #include <assert.h>
 #include <time.h>
 
diff -urN wormik/wormik.dsp wormik-windos/wormik.dsp
--- wormik/wormik.dsp	1970-01-01 01:00:00.000000000 +0100
+++ wormik-windos/wormik.dsp	2003-11-28 15:31:20.000000000 +0100
@@ -0,0 +1,113 @@
+# Microsoft Developer Studio Project File - Name="wormik" - Package Owner=<4>
+# Microsoft Developer Studio Generated Build File, Format Version 6.00
+# ** DO NOT EDIT **
+
+# TARGTYPE "Win32 (x86) Console Application" 0x0103
+
+CFG=wormik - Win32 Debug
+!MESSAGE This is not a valid makefile. To build this project using NMAKE,
+!MESSAGE use the Export Makefile command and run
+!MESSAGE 
+!MESSAGE NMAKE /f "wormik.mak".
+!MESSAGE 
+!MESSAGE You can specify a configuration when running NMAKE
+!MESSAGE by defining the macro CFG on the command line. For example:
+!MESSAGE 
+!MESSAGE NMAKE /f "wormik.mak" CFG="wormik - Win32 Debug"
+!MESSAGE 
+!MESSAGE Possible choices for configuration are:
+!MESSAGE 
+!MESSAGE "wormik - Win32 Release" (based on "Win32 (x86) Console Application")
+!MESSAGE "wormik - Win32 Debug" (based on "Win32 (x86) Console Application")
+!MESSAGE 
+
+# Begin Project
+# PROP AllowPerConfigDependencies 0
+# PROP Scc_ProjName ""
+# PROP Scc_LocalPath ""
+CPP=cl.exe
+RSC=rc.exe
+
+!IF  "$(CFG)" == "wormik - Win32 Release"
+
+# PROP BASE Use_MFC 0
+# PROP BASE Use_Debug_Libraries 0
+# PROP BASE Output_Dir "Release"
+# PROP BASE Intermediate_Dir "Release"
+# PROP BASE Target_Dir ""
+# PROP Use_MFC 0
+# PROP Use_Debug_Libraries 0
+# PROP Output_Dir "Release"
+# PROP Intermediate_Dir "Release"
+# PROP Ignore_Export_Lib 0
+# PROP Target_Dir ""
+# ADD BASE CPP /nologo /W3 /GX /O2 /D "WIN32" /D "NDEBUG" /D "_CONSOLE" /D "_MBCS" /YX /FD /c
+# ADD CPP /nologo /W3 /GX /O2 /I "SDL-1.2.6/include" /D "WIN32" /D "NDEBUG" /D "_CONSOLE" /D "_MBCS" /D SVERSION=\"1.0\" /YX /FD /c
+# ADD BASE RSC /l 0x405 /d "NDEBUG"
+# ADD RSC /l 0x405 /d "NDEBUG"
+BSC32=bscmake.exe
+# ADD BASE BSC32 /nologo
+# ADD BSC32 /nologo
+LINK32=link.exe
+# ADD BASE LINK32 kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib /nologo /subsystem:console /machine:I386
+# ADD LINK32 kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib SDL.lib SDL_image.lib SDL_ttf.lib SDLmain.lib /nologo /subsystem:console /machine:I386 /libpath:"SDL-1.2.6/lib"
+
+!ELSEIF  "$(CFG)" == "wormik - Win32 Debug"
+
+# PROP BASE Use_MFC 0
+# PROP BASE Use_Debug_Libraries 1
+# PROP BASE Output_Dir "wormik___Win32_Debug"
+# PROP BASE Intermediate_Dir "wormik___Win32_Debug"
+# PROP BASE Target_Dir ""
+# PROP Use_MFC 0
+# PROP Use_Debug_Libraries 1
+# PROP Output_Dir "wormik___Win32_Debug"
+# PROP Intermediate_Dir "wormik___Win32_Debug"
+# PROP Target_Dir ""
+# ADD BASE CPP /nologo /W3 /Gm /GX /ZI /Od /D "WIN32" /D "_DEBUG" /D "_CONSOLE" /D "_MBCS" /YX /FD /GZ /c
+# ADD CPP /nologo /W3 /Gm /GX /ZI /Od /D "WIN32" /D "_DEBUG" /D "_CONSOLE" /D "_MBCS" /YX /FD /GZ /c
+# ADD BASE RSC /l 0x405 /d "_DEBUG"
+# ADD RSC /l 0x405 /d "_DEBUG"
+BSC32=bscmake.exe
+# ADD BASE BSC32 /nologo
+# ADD BSC32 /nologo
+LINK32=link.exe
+# ADD BASE LINK32 kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib /nologo /subsystem:console /debug /machine:I386 /pdbtype:sept
+# ADD LINK32 kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib kernel32.lib user32.lib gdi32.lib winspool.lib comdlg32.lib advapi32.lib shell32.lib ole32.lib oleaut32.lib uuid.lib odbc32.lib odbccp32.lib /nologo /subsystem:console /debug /machine:I386 /pdbtype:sept
+
+!ENDIF 
+
+# Begin Target
+
+# Name "wormik - Win32 Release"
+# Name "wormik - Win32 Debug"
+# Begin Group "Source Files"
+
+# PROP Default_Filter "cpp;c;cxx;rc;def;r;odl;idl;hpj;bat"
+# Begin Source File
+
+SOURCE=.\WormikGame.cxx
+# End Source File
+# Begin Source File
+
+SOURCE=.\gui_common.cxx
+# End Source File
+# Begin Source File
+
+SOURCE=.\Wormik_SDL.cxx
+# End Source File
+# Begin Source File
+
+SOURCE=.\main.cxx
+# End Source File
+# End Group
+# Begin Group "Header Files"
+
+# PROP Default_Filter "h;hpp;hxx;hm;inl"
+# End Group
+# Begin Group "Resource Files"
+
+# PROP Default_Filter "ico;cur;bmp;dlg;rc2;rct;bin;rgs;gif;jpg;jpeg;jpe"
+# End Group
+# End Target
+# End Project
diff -urN wormik/wormik.dsw wormik-windos/wormik.dsw
--- wormik/wormik.dsw	1970-01-01 01:00:00.000000000 +0100
+++ wormik-windos/wormik.dsw	2003-11-28 15:25:24.000000000 +0100
@@ -0,0 +1,29 @@
+Microsoft Developer Studio Workspace File, Format Version 6.00
+# WARNING: DO NOT EDIT OR DELETE THIS WORKSPACE FILE!
+
+###############################################################################
+
+Project: "wormik"=.\wormik.dsp - Package Owner=<4>
+
+Package=<5>
+{{{
+}}}
+
+Package=<4>
+{{{
+}}}
+
+###############################################################################
+
+Global:
+
+Package=<5>
+{{{
+}}}
+
+Package=<3>
+{{{
+}}}
+
+###############################################################################
+
